---
title: "ä»£è°¢ç»„éƒ¨åˆ†"
author: "Shawn Wang"
date: Aug 22,2022
format: html
editor: visual
bibliography: PosDocProject.bib
---

<center>

<font color=salmon size=2pt> ğŸ¡Zhang Lab, Aug 05, 2022 ğŸ¡</font>

<font color=green size=2pt> ğŸ”¬Multi-omics research center, State Key Laboratory of Crop Stress Adaption and Improvement, HENU, Kaifeng, Henan ğŸ”¬</font>

</center>

# æ–¹æ³•

**å–æ ·æ–¹å¼æè¿°ï¼š** æˆ‘ä»¬åœ¨é‡å¤–è¿›è¡Œäº†é»„ç²¾å—èŒçš„é‡‡é›†ï¼Œæ ¹æ®ç»éªŒè·å–äº†ä¸åŒç”Ÿé•¿å¹´é™çš„ææ–™ï¼Œç²—ç•¥åˆ†ä¸ºå¹¼å¹´ææ–™`size1-3`å’Œæˆå¹´ææ–™`size5-6`,`size4`ä»‹äºå¹¼å¹´å’Œæˆå¹´ææ–™ä¹‹é—´ã€‚

## å®éªŒæ–¹æ³•

èµµå…µæä¾›ï¼›

### Metabolites Extraction

All collected samples were flash frozen and ground to a fine powder with a mortar and pestle. The powder of each sample was extracted overnight using 80% HPLC grade methanol containing 1 Î¼M chrysin as the internal standard and the ratio of the fresh weight to the volume of extraction solution was kept as 0.1 g/ml. The undissolved sample residues were precipitated by centrifugation at 13000 rpm for 30 min at 4â„ƒ. The clear supernatants were loaded into injection vials and ready for UHPLC-MS/MS.

### High-Performance Liquid Chromatography

For UHPLC-MS/MS assay, The vanquish-flex UHPLC system was coupled to Q Exactive Plus mass spectrometry (Thermo Fisher Scientific) for metabolite separation and detection. A Hypersil GOLD column (2.1Ã—100 mm.1.9 um; Thermo Fisher Scientific) was employed for compound separation at 30Â°C and 5 Î¼l of sample was loaded. The mobile phase A was HPLC grade H2O with 0.1% (v/v) formic acid (Merck, Germany) and phase B was HPLC grade acetonitrile (Merck, Germany). The gradient elution conditions were set as follows: From 0 to 2min, the mobile phase B increases to 10%; From 2 to 10min, the mobile phase B increases to 50%; From 10 to 10.1minï¼Œ the mobile phase B increases to 80%; From 10.1 to 13 min, the mobile phase B was kept at 80%; From 13 to 14 min the mobile phase B increases to 95%; From 14-18 min the mobile phase B decreased to 10%. The flow rate was 0.3 ml/min. The MS data acquisition was performed by Q Exactive Plus (ThermoFisher Scientific, Rockford, IL) system. In full scan MS/ddMS2 mode, the resolutions of full scan MS and ddMS2 were set at 70000 and 17500, respectively. The automatic gain control (AGC) target and maximum injection time in full scan MS settings were 1e6 and 100 ms, while their values were 2e5 and 50 ms in dd MS2 settings. The TopN (N, the number of top most abundant ions for fragmentation) was set to 8, and collision energy was set to 20%, 40% and 60%. A heated ESI source was used at positive and negative ion mode. the spray voltage was set as 3.5 KV for positive mode and 3.2 KV for negative mode;The capillary temperature and aux gas heater temperature were set as 320 and 350 Â°C, respectively. Sheath gas and aux gas flow rate were set at 35 and 15 (in arbitrary units), respectively. The S-lens RF level was 50.

## æ•°æ®å¤„ç†

1.  **æ•°æ®æ ¼å¼è½¬æ¢ï¼š** å¾—åˆ°`.raw`çš„ä¸‹æœºæ•°æ®åï¼Œæˆ‘ä»¬é€šè¿‡[dockerç‰ˆæœ¬çš„ProteoWizard msConvert](https://hub.docker.com/r/chambm/pwiz-skyline-i-agree-to-the-vendor-licenses) @adusumilliDataConversionProteoWizard2017 å°†åŸå§‹æ•°æ®è½¬æ¢ä¸ºåŒ…å«MS1ä¿¡æ¯çš„`.mzXML`æ ¼å¼ï¼Œä»¥åŠåŒ…å«MS/MSä¿¡æ¯çš„`.mgf`æ ¼å¼ã€‚

2.  **æå³°ã€æ•°æ®æ¸…æ´—ï¼š** æˆ‘ä»¬é€šè¿‡`tidymass` @shenTidyMassObjectorientedReproducible2022 å¯¹åŸå§‹æ•°æ®è¿›è¡Œæå³°ï¼Œæ•°æ®æ¸…æ´—åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š

    2.1 ç¼ºå¤±å€¼æ£€æµ‹ï¼Œ é¦–å…ˆå¯¹ä»£è°¢ç‰©ç§¯ç´¯çŸ©é˜µæ‰€æœ‰æ£€æµ‹åˆ°çš„`feature`è¿›è¡Œç¼ºå¤±å€¼æ£€æµ‹ï¼Œç»Ÿè®¡ã€‚\
    2.2 å™ªéŸ³å»é™¤ï¼Œ åˆ¤æ–­ä¸€ä¸ªfeatureæ˜¯å¦ä¸ºnoiseçš„æ¡ä»¶ä¸ºï¼šåœ¨æ‰€æœ‰QCæ ·å“ä¸­è¯¥featureçš„ç¼ºå¤±é¢‘ç‡å¤§äº20%ã€‚\
    2.3 æ‰¹æ¬¡æ•ˆåº”æ£€æµ‹ï¼Œå»é™¤noiseåé€šè¿‡å¯¹æ‰€æœ‰QCæ ·æœ¬ä¸­featureå³°é¢ç§¯ç»Ÿè®¡å¯ä»¥è§‚æµ‹åˆ°æ˜¯å¦æœ‰batch effectã€‚\
    2.4 ç¼ºå¤±å€¼å¡«å……ï¼Œä½¿ç”¨`tidymass`çš„`knn`ç®—æ³•å¡«å……ç¼ºå¤±å€¼ã€‚\
    2.5 æ•°æ®å½’ä¸€åŒ–ï¼šä½¿ç”¨`tidymass`æ”¯æŒå‘é‡æœºç®—æ³•å¯¹æ•°æ®è¿›è¡Œå½’ä¸€åŒ–ã€‚ @shenNormalizationIntegrationLargescale2016ã€‚\
    2.6 æ•°æ®æ•´åˆã€‚

3.  **ä»£è°¢ç‰©æ³¨é‡Šï¼š** æˆ‘ä»¬ä½¿ç”¨ä»¥ä¸‹æ•°æ®åº“å¯¹æ£€æµ‹åˆ°çš„featureè¿›è¡Œæ³¨é‡Šï¼š

    3.1 [MassBank of North America, MoNA](https://mona.fiehnlab.ucdavis.edu/downloads) MS2;\
    3.2 [MassBank](https://massbank.eu/MassBank/) MS2;\
    3.3 [Human Metabolome Database, HMDB](https://hmdb.ca/downloads) MS2;\
    3.4 [Vaniya/Fiehn Natural Products Library](https://mona.fiehnlab.ucdavis.edu/spectra/browse?query=tags.text%3D%3D%22VF-NPL%22) MS2;\
    3.5 [RIKEN PlaSMA](https://mona.fiehnlab.ucdavis.edu/spectra/browse?query=tags.text%3D%3D%22RIKEN%20PlaSMA%22) MS2;\
    3.6 Tidymass å†…ç½®çš„RPLCã€Fieh_hilicæ•°æ®åº“ MS2ï¼›\
    3.7 [KNApSAcK](http://www.knapsackfamily.com/KNApSAcK/) MS1;\
    3.8 [PlantCyc](https://plantcyc.org/) MS1;\
    3.9 [KEGG](https://www.genome.jp/kegg/) MS1.\
    3.10 [MetDNA2](http://metdna.zhulab.cn/) å»å™ªåæˆ‘ä»¬å°†å‰©ä½™çš„featureçš„MS1åŠMS2çš„æ•°æ®å¯¼å‡ºï¼Œé€šè¿‡`MetDNA2`å¯¹featureè¿›è¡Œæ³¨é‡Š MetDNA2 @shenMetabolicReactionNetworkbased2019ï¼›

4.  **æ³¨é‡Šè¿‡æ»¤åŠæ•´åˆï¼š** æœåº“çš„æ—¶å€™æ¯ä¸ªæ•°æ®åº“ä¼šç»™å‡º3ä¸ªåŒ¹é…åº¦æœ€é«˜çš„candidates,æˆ‘ä»¬ä¼šé€šè¿‡ä»¥ä¸‹æ–¹å¼å¯¹æ³¨é‡Šè¿›è¡Œè¿‡æ»¤åŠå»å†—ä½™ï¼š

    4.1 å¯¹äºæœ‰MS/MSä¿¡æ¯åŒ¹é…æˆåŠŸçš„æˆ‘ä»¬ä¿ç•™æ‰€æœ‰åŠ åˆç¦»å­æ¨¡å¼åŒ¹é…ï¼Œå¯¹äºåªæœ‰MS1åŒ¹é…çš„featureï¼Œæˆ‘ä»¬åªä¿ç•™`[M+H]+`ä»¥åŠ`[M-H]-`çš„ç»“æœã€‚\
    4.2 å¯¹äºæ³¨é‡Šåˆ°åŒä¸€ä»£è°¢ç‰©çš„featureï¼Œä¼˜å…ˆä¿ç•™æœ‰MS/MSä¿¡æ¯çš„feature. ç„¶åæ ¹æ®tidymassç»™å‡ºçš„åŒ¹é…åº¦æ€»å¾—åˆ†ï¼ˆTotal scoreï¼‰é€‰å–å¾—åˆ†æœ€é«˜çš„ä¸€ä¸ªfeature.\
    4.3 å¯¹äºåŒä¸€ä¸ªfeatureæ³¨é‡Šåˆ°ä¸åŒçš„ä»£è°¢ç‰©çš„æƒ…å†µï¼Œæˆ‘ä»¬è¿˜æ˜¯ä¼˜å…ˆä¿ç•™MS/MSåŒ¹é…çš„ï¼Œæ¬¡ä¼˜å…ˆä¿ç•™`[M+H]+`æˆ–è€…`[M-H]-`æ¨¡å¼ï¼Œæœ€åå†æ ¹æ®total scoreä¿ç•™ã€‚ 4.4 å¯¹äºMetDNAçš„æ³¨é‡Šæˆ‘ä»¬æ²¡æœ‰è¿›è¡Œè¿‡å¤šçš„å¤„ç†ï¼Œç›´æ¥å°†ç»“æœæ•´åˆè¿›æ¥ã€‚

5.  **ä»£è°¢ç‰©åˆ†ç±»ï¼š** æˆ‘ä»¬æ ¹æ®ä»£è°¢ç‰©çš„`InChiKey`ä¿¡æ¯é€šè¿‡Classyfire @djoumboufeunangClassyFireAutomatedChemical2016 æ•°æ®åº“å°†ä»£è°¢ç‰©è¿›è¡Œåˆ†ç±»ï¼Œä¸ºäº†æ›´å¥½çš„å¯è§†åŒ–åˆ†ç±»ç»“æœï¼Œæˆ‘ä»¬å°†åˆ†ç±»ç»“æœä¸­ä»£è°¢ç‰©æ•°é‡å¤§äºç­‰äº10ä¸ªçš„ç§°ä¸ºmajor classï¼Œ3-9çš„å«tiny classï¼Œå°äº3ä¸ªçš„å½’ç±»ä¸ºother class.

6.  **PCAï¼š**æˆ‘ä»¬ä½¿ç”¨å»å™ªåå‰©ä½™çš„featureåšPCAåˆ†æï¼Œé¦–å…ˆå¯¹æ ‡å‡†åŒ–åçš„å³°é¢ç§¯åšäº†log10çš„è½¬æ¢ï¼Œç”¨RåŒ…[PCAtools](http://mirrors.nju.edu.cn/bioconductor/3.15/bioc/html/PCAtools.html) è¿›è¡ŒPCAè®¡ç®—ï¼Œç”¨[scatterplot3DåŒ…](https://cran.r-project.org/web/packages/scatterplot3d/index.html)è¿›è¡Œå¯è§†åŒ–.

7.  **çƒ­å›¾ï¼š** æˆ‘ä»¬å°†æœ€ç»ˆæ³¨é‡Šåˆ°çš„åŒ–åˆç‰©é€šè¿‡[ComplexHeatmap](https://github.com/jokergoo/ComplexHeatmap) @guComplexHeatmapsReveal2016 è¿›è¡Œäº†å¯è§†åŒ–ï¼Œå¹¶ä¸”ä½¿ç”¨`column_km=12`ä»¥åŠ`column_km_repeat = 5000`å‚æ•°å¯¹ä»£è°¢ç‰©åšäº†5000æ¬¡çš„é‡å¤çš„k-meansåˆ†æ,æœ€ç»ˆå°†ä»£è°¢ç‰©åˆ†äº†12ä¸ªcluster. ç„¶åé€šè¿‡è®¡ç®—æ¯ä¸ªclusterçš„å‡å€¼ç»˜åˆ¶äº†å¯¹åº”clusterçš„ç‰¹å¾æ›²çº¿ã€‚

# ç»“æœï¼š

## ä»£è°¢ç‰©æå³°ï¼Œè¿‡æ»¤ï¼Œæ³¨é‡Šç»Ÿè®¡ç»“æœï¼š

<center>**è¡¨1. æ•°æ®æ¸…æ´—æ­¥éª¤ä¸­featureæ•°é‡çš„ç»Ÿè®¡**</center>

| Ion      | original | remove noise | Annotation |
|----------|----------|--------------|------------|
| Negative | 12316    | 2156         | 362        |
| Positive | 16809    | 3962         | 414        |
| total    | 29125    | 6618         | 776        |

<center>**è¡¥å……è¡¨1. æœ€ç»ˆ776ä¸ªä»£è°¢ç‰©ç§¯ç´¯çŸ©é˜µ**</center>

```{r,message=FALSE, warning=FALSE, include=FALSE, out.width='100%'}
suppressMessages(library(bruceR))
```

```{r,echo=FALSE, message=FALSE, warning=FALSE,}
Tables1 <- import("../04.Result/01.Tables/TableS1.Accumulation_Matrix.xlsx",sheet = 1)
colnames(Tables1) = Tables1[1,]
Tables1 = Tables1[2:15,] %>% 
  mutate(Size_1 = as.numeric(Size_1),
         Size_2 = as.numeric(Size_2),
         Size_3 = as.numeric(Size_3),
         Size_4 = as.numeric(Size_4),
         Size_5 = as.numeric(Size_5),
         Size_6 = as.numeric(Size_6))
print_table(Tables1,digits = 2)
```

<center>**è¡¥å……è¡¨2. ä»£è°¢ç‰©æ³¨é‡Š**</center>

```{r,echo=FALSE, message=FALSE, warning=FALSE,}
Tables2 <- import("../04.Result/01.Tables/TableS2.Compound_Annotation.xlsx",sheet = 1)
colnames(Tables2) = Tables2[1,]
Tables2 = Tables2[2:10,-7]
colnames(Tables2)[3] = "rt"
print_table(Tables2,digits = 2)
```

<center>**è¡¥å……è¡¨3. ä»£è°¢ç‰©åˆ†ç±»**</center>

```{r,echo=FALSE, message=FALSE, warning=FALSE}
Tables3 <- import("../04.Result/01.Tables/TableS3.Compound_classification.xlsx",sheet = 1)
colnames(Tables3) = Tables3[1,]
Tables3 = Tables3[2:10,]
colnames(Tables3)[3] = "rt"
print_table(Tables3,digits = 2)
```

## ç»“æœåˆ†æ

### æ•°æ®æ¸…æ´—éƒ¨åˆ†

ç»è¿‡æå³°æˆ‘ä»¬ä»æ­£è°±å’Œè´Ÿè°±å…±å¾—åˆ°29125ï¼ˆpos: 12316, neg:16809ï¼‰ä¸ªfeature. ç»è¿‡è¿‡æ»¤ï¼Œæˆ‘ä»¬å¾—åˆ°6618ï¼ˆpos: 2156ï¼Œ neg: 3962ï¼‰ä¸ªfeatureï¼Œè¿™äº›featureåœ¨è‡³å°‘80%çš„è´¨æ§æ ·æœ¬ä¸­éƒ½å¯ä»¥æ£€æµ‹åˆ°ã€‚ç»è¿‡ä¸ä¼—å¤šåœ¨çº¿æ•°æ®åº“æ¯”å¯¹åŠMetDNA2çš„æ³¨é‡Šï¼Œæˆ‘ä»¬æœ€ç»ˆä»æ­£è°±ç­›é€‰å‡º362ä¸ªä»è´Ÿè°±ç­›é€‰å‡º414ä¸ªå…·æœ‰è¾ƒé«˜ç½®ä¿¡åº¦çš„ï¼Œæœ‰è¾ƒä¸ºå‡†ç¡®æ³¨é‡Šçš„åŒ–åˆç‰©è¿›è¡Œä¸‹æ¸¸åˆ†æã€‚  

æ­£è°±æ“ä½œæ­£å¸¸ï¼Œè´Ÿè°±å‰4ä¸ªQCå­˜åœ¨å¾®å¼±çš„æ‰¹æ¬¡æ•ˆåº”ï¼Œç»è¿‡å½’ä¸€åŒ–æ•´åˆï¼Œæ‰¹æ¬¡æ•ˆåº”è¢«å»é™¤ï¼ˆFigure S1.ï¼‰æ˜¾ç„¶è¿™ç§å·®å¼‚æ˜¯ç³»ç»Ÿè¯¯å·®ï¼ˆsystematic errorï¼‰ã€‚  

æˆ‘ä»¬å¯¹æ‰€æœ‰æ£€æµ‹åˆ°çš„featureåšäº†PCAåˆ†æï¼ˆFigure S2ï¼‰ï¼Œç»è¿‡æ•°æ®æ ‡å‡†åŒ–æˆ‘ä»¬å‘ç°æ‰€æœ‰çš„`QC`æ ·æœ¬éƒ½èšåœ¨ä¸€èµ·ï¼Œè¯´æ˜ç³»ç»Ÿè¯¯å·®è¢«å¾ˆå¥½çš„æ¶ˆé™¤äº†ï¼Œè´Ÿè°±çš„æ‰¹æ¬¡æ•ˆåº”ä¹Ÿè¢«å¾ˆå¥½çš„æ¶ˆé™¤ã€‚æ­¤å¤–æˆ‘ä»¬å‘ç°æ— è®ºåœ¨æ­£è°±è¿˜æ˜¯è´Ÿè°±æˆå¹´ææ–™ä¸­çš„`size5`éƒ½æ˜æ˜¾åŒºåˆ«ä¸å…¶ä»–ææ–™ï¼Œè´Ÿè°±ä¸­`size6`ä¹Ÿå¯ä»¥å’Œå¹¼å¹´ææ–™åŒºåˆ†å¼€ï¼Œä½†ä¼¼ä¹è¿‡æ¸¡ææ–™`size4`æ›´è¶‹å‘äºå¹¼å¹´ææ–™ã€‚å½“ç„¶

::: {#fig-batcheffect layout-nrow=2}
![Figure S1. Batch effect detection](FigS1.batch_effect_boxplot.png){#figS1-Boxplot}  

![FigureS2. Raw data pca](FigS2.raw_data_pca.png){#figS2-pca}

batch effect
:::

### æ•´ä½“ç»“æœåˆ†æ

::: {#fig-overview layout-ncol="1"}
![Figure 2. overview of metabolomics data](Fig2.Metabo_overview.png){#fig2-overview}

overview
:::
